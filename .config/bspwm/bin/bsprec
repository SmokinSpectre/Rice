#!/bin/bash 
RECORDINGS_DIR=~/Videos/Recordings
SCREEN_RESOLUTION="$(xwininfo -root | grep geometry | awk '{print $2}' | cut -d + -f1)"
AUDIO=" -f pulse -ac 2 -i default "

if [ ! -d "$RECORDINGS_DIR" ]; then
    mkdir -p "$RECORDINGS_DIR"
fi

pid="$(ps -o pid,command ax | grep "ffmpeg" | grep "x11grab" | awk '{print $1}')"
if [ -z "$pid" ]; then
    TIMESTAMP="$(date +%Y.%m.%d-%H.%M.%S)"
    FILENAME=$RECORDINGS_DIR/$TIMESTAMP.screenrec.mp4

    notify-send "Recording Screen" --urgency low -i $REC_ICON_PATH
    ffmpeg -f x11grab -s $SCREEN_RESOLUTION -i :0.0 -vcodec libx264 -preset medium -crf 22 -y $FILENAME

    notify-send "Screen Recording Over" --urgency low -i $REC_ICON_PATH
else
    kill $pid
fi
